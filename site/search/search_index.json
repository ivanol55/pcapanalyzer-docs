{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"PCAPAnalyzer project documentation Welcome! This is the site where you'll find reference documentation for all things PCAPAnalyzer, from frontend usage, to backend management, to API interaction. Documentation structure getting started - your starting point prerequisites - what you need to setup first installation - let's set you up main server - The base install agent - gather data from other sources post-install - what you should know frontend - Where you'll find documentation about UI interaction and features. login - web authentication homepage - a quick summary packetStream - data filtering dataGlance - quick, usually needed info queryRunner - roll your own SQL dbCreator - analyze your own pcaps database picker - manage database usage About - manage internal tokens User management - manage webUI users API management - manage API tokens backend .my.cnf - application information packetStream - constant data gathering PCAPAnalyzer IDS - get attack warnings by mail analysisGenerator - generate custom database reports API authentication - allowing requests endpoints - what can you do? dblist - listing databases rawnumbers - quick data for dashboards insights - dataGlance in JSON format reference - Quick query and answer manuals","title":"Home"},{"location":"#pcapanalyzer-project-documentation","text":"Welcome! This is the site where you'll find reference documentation for all things PCAPAnalyzer, from frontend usage, to backend management, to API interaction.","title":"PCAPAnalyzer project documentation"},{"location":"#documentation-structure","text":"getting started - your starting point prerequisites - what you need to setup first installation - let's set you up main server - The base install agent - gather data from other sources post-install - what you should know frontend - Where you'll find documentation about UI interaction and features. login - web authentication homepage - a quick summary packetStream - data filtering dataGlance - quick, usually needed info queryRunner - roll your own SQL dbCreator - analyze your own pcaps database picker - manage database usage About - manage internal tokens User management - manage webUI users API management - manage API tokens backend .my.cnf - application information packetStream - constant data gathering PCAPAnalyzer IDS - get attack warnings by mail analysisGenerator - generate custom database reports API authentication - allowing requests endpoints - what can you do? dblist - listing databases rawnumbers - quick data for dashboards insights - dataGlance in JSON format reference - Quick query and answer manuals","title":"Documentation structure"},{"location":"about/","text":"About this project This is the documentation for the PCAPAnalyzer project, created by Ivan Mendez , Sergi pellejero and Luis Portillo . All parts of this project, both this docummentation and the program itself, are licensed under the GNU General Public License v3 .","title":"About"},{"location":"about/#about-this-project","text":"This is the documentation for the PCAPAnalyzer project, created by Ivan Mendez , Sergi pellejero and Luis Portillo . All parts of this project, both this docummentation and the program itself, are licensed under the GNU General Public License v3 .","title":"About this project"},{"location":"frontend/about/","text":"About PCAPAnalyzer developer credit and licensing On the about page of PCAPAnalyzer you will find some information about the project, and some frontend management settings. First you can see information about the software version, licensing details, and developer credit. Identity and Access Management You can also change the frontend page css for your session between the light and dark themes. On the bottom of this page, you will find two identity and access management options: one to create and delete users to access the frontend webapp, and one for managing API secrets for API requests. User management On this site, you can either create custom users and passwords to insert into the pcapanalyzer_creds database on the users table, or you can drop existing users under this form. Keep in mind, you are not allowed to drop all of the users on the system: there has to be at least one. API management On this page you can generate new API keys, stored on the pcapanalyzer_creds database under the apikeys table, or drop API keys. If you want to, you can drop all of the API keys so no one has possible access to the API.","title":"about"},{"location":"frontend/about/#about-pcapanalyzer","text":"","title":"About PCAPAnalyzer"},{"location":"frontend/about/#developer-credit-and-licensing","text":"On the about page of PCAPAnalyzer you will find some information about the project, and some frontend management settings. First you can see information about the software version, licensing details, and developer credit.","title":"developer credit and licensing"},{"location":"frontend/about/#identity-and-access-management","text":"You can also change the frontend page css for your session between the light and dark themes. On the bottom of this page, you will find two identity and access management options: one to create and delete users to access the frontend webapp, and one for managing API secrets for API requests.","title":"Identity and Access Management"},{"location":"frontend/about/#user-management","text":"On this site, you can either create custom users and passwords to insert into the pcapanalyzer_creds database on the users table, or you can drop existing users under this form. Keep in mind, you are not allowed to drop all of the users on the system: there has to be at least one.","title":"User management"},{"location":"frontend/about/#api-management","text":"On this page you can generate new API keys, stored on the pcapanalyzer_creds database under the apikeys table, or drop API keys. If you want to, you can drop all of the API keys so no one has possible access to the API.","title":"API management"},{"location":"frontend/database-picker/","text":"Database picker When you click on the menu entry for Current database , you will be redirected to the database management page. In this site, you will get two different options: you can either change what database you want to use for analysis, or you can delete databases when you're done with them. On the first option, you need to pick the database you want to see the data of from the drop-down menu, then click confirm . The app will then redirect you to the system homepage with your new database as the active data source. If you're done with a database and you want to delete it from the system, use the lower form. Select the database you wanna drop, then click drop . The database will be deleted, and you will be redirected to the homepage with packetstream as the new data source database.","title":"database picker"},{"location":"frontend/database-picker/#database-picker","text":"When you click on the menu entry for Current database , you will be redirected to the database management page. In this site, you will get two different options: you can either change what database you want to use for analysis, or you can delete databases when you're done with them. On the first option, you need to pick the database you want to see the data of from the drop-down menu, then click confirm . The app will then redirect you to the system homepage with your new database as the active data source. If you're done with a database and you want to delete it from the system, use the lower form. Select the database you wanna drop, then click drop . The database will be deleted, and you will be redirected to the homepage with packetstream as the new data source database.","title":"Database picker"},{"location":"frontend/dataglance/","text":"dataGlance When you need quick info about some specific data, you can use dataGlance . This page provides tables with frequently consulted data: Private range IPs found Public range IPs found MAC addresses seen protocols registered Well-known ports Ports over 1024 that are not dynamic This data is refreshed every time you reload the page, and it is dependant on the database you're currently analyzing. This data is also available through the API .","title":"dataGlance"},{"location":"frontend/dataglance/#dataglance","text":"When you need quick info about some specific data, you can use dataGlance . This page provides tables with frequently consulted data: Private range IPs found Public range IPs found MAC addresses seen protocols registered Well-known ports Ports over 1024 that are not dynamic This data is refreshed every time you reload the page, and it is dependant on the database you're currently analyzing. This data is also available through the API .","title":"dataGlance"},{"location":"frontend/dbcreator/","text":"dbCreator analysis database generator Apart from the packetstream data capture system, you can also upload your own .pcap files for the PCAPAnalyzer system to generate analysis databases with. On this form, you will input a database name, then upload all of your .pcap files to read into the system. Once this is done, click on Create new database for the system to start the process. This page will stay loading until the process is done. Do not close the page until you are redirected to the system's homepage. Keep in mind that depending on the size of your .pcap files and system performance, this process could take some time to complete. You can upload, at most, 100 megabyte individual files, or a total of 200 megabytes of data. Once the database creation process is complete, you can proceed to the database picker and start doing data analysis on your new database.","title":"dbCreator"},{"location":"frontend/dbcreator/#dbcreator-analysis-database-generator","text":"Apart from the packetstream data capture system, you can also upload your own .pcap files for the PCAPAnalyzer system to generate analysis databases with. On this form, you will input a database name, then upload all of your .pcap files to read into the system. Once this is done, click on Create new database for the system to start the process. This page will stay loading until the process is done. Do not close the page until you are redirected to the system's homepage. Keep in mind that depending on the size of your .pcap files and system performance, this process could take some time to complete. You can upload, at most, 100 megabyte individual files, or a total of 200 megabytes of data. Once the database creation process is complete, you can proceed to the database picker and start doing data analysis on your new database.","title":"dbCreator analysis database generator"},{"location":"frontend/homepage/","text":"Web frontend homepage THe homepage presents a table with quick information about data on every database on the PCAPAnalyzer data management system. For every logging database, you get information about: The total number of stored packets on the database The number of data sources or agents logged (only available for packetstream ) The number of external IPs contacted How many different MACs have been found on the registry How many of the total packets were multicast How many different protocols were registered in the system This table is generated again every time you reload the homepage. This data is also available through the API .","title":"homepage"},{"location":"frontend/homepage/#web-frontend-homepage","text":"THe homepage presents a table with quick information about data on every database on the PCAPAnalyzer data management system. For every logging database, you get information about: The total number of stored packets on the database The number of data sources or agents logged (only available for packetstream ) The number of external IPs contacted How many different MACs have been found on the registry How many of the total packets were multicast How many different protocols were registered in the system This table is generated again every time you reload the homepage. This data is also available through the API .","title":"Web frontend homepage"},{"location":"frontend/login/","text":"Frontend login Once you open the web frontend for your install, you will be greeted by a login screen. If this is your first time, you'll have to provide the web login credentials given to you by the installer script. Once you're inside the web frontend, you can create new users with your own passwords (see \"about\") at the end of this Frontend documentation category. The default username for the web frontend upon install is admin . The password is randomly generated for every install and is only output in plaintext once by the install script. These web frontend passwords are stored in the database, in bcrypt hash format using the blowfish non-cryptographically reversible algorithm. Once a password is sent in the form with a post request, the check script will check the username and password on the system. If the user does not exist or you submitted a wrong username and password, you will be redirected back to the login form with an error message. If the username exists on the pcapanalyzer_creds database inside of the users table, and the bcrypt hash matches the one calculated on the frontend form, you will be redirected to the PCAPAnalyzer frontend homepage.","title":"login"},{"location":"frontend/login/#frontend-login","text":"Once you open the web frontend for your install, you will be greeted by a login screen. If this is your first time, you'll have to provide the web login credentials given to you by the installer script. Once you're inside the web frontend, you can create new users with your own passwords (see \"about\") at the end of this Frontend documentation category. The default username for the web frontend upon install is admin . The password is randomly generated for every install and is only output in plaintext once by the install script. These web frontend passwords are stored in the database, in bcrypt hash format using the blowfish non-cryptographically reversible algorithm. Once a password is sent in the form with a post request, the check script will check the username and password on the system. If the user does not exist or you submitted a wrong username and password, you will be redirected back to the login form with an error message. If the username exists on the pcapanalyzer_creds database inside of the users table, and the bcrypt hash matches the one calculated on the frontend form, you will be redirected to the PCAPAnalyzer frontend homepage.","title":"Frontend login"},{"location":"frontend/packetstream/","text":"PCAPAnalyzer PacketStream The PacketStream tab allows you to look at every network packet that is logged on the database. For every packet registered on the system you can see: a UTC timestamp the machine ID that provided the data [!] only available on the packetstream database Source MAC address Destination MAC address Source IP address Destination IP address Protocol used Source port Destination port packet content info This data is reverse indexed and ordered by entry id, so retrieval is as fast as possible. Then, on top of this table, you see a filter set form. In this form, you can input a value for any of the columns stated as a filter. You can use as many filters as you need, but keep in mind they work in an AND basis: a packet has to fit all of your filter criteria to appear on the table. Once all of your filters are set, you will need to click apply filters to apply them. If you want to reset all your set filters, you can use the reset filters button.","title":"packetStream"},{"location":"frontend/packetstream/#pcapanalyzer-packetstream","text":"The PacketStream tab allows you to look at every network packet that is logged on the database. For every packet registered on the system you can see: a UTC timestamp the machine ID that provided the data [!] only available on the packetstream database Source MAC address Destination MAC address Source IP address Destination IP address Protocol used Source port Destination port packet content info This data is reverse indexed and ordered by entry id, so retrieval is as fast as possible. Then, on top of this table, you see a filter set form. In this form, you can input a value for any of the columns stated as a filter. You can use as many filters as you need, but keep in mind they work in an AND basis: a packet has to fit all of your filter criteria to appear on the table. Once all of your filters are set, you will need to click apply filters to apply them. If you want to reset all your set filters, you can use the reset filters button.","title":"PCAPAnalyzer PacketStream"},{"location":"frontend/queryrunner/","text":"queryRunner SQL form In the queryRunner tab of the web fronend, you get a text field where you can write your own SQL SELECT query, in the event that the packetstream table is limited for your needs. You need to write your SQL query inside of the text field on the page (as specified, the data table is always named main ), and when it's done, click on the Run query button to run it. Once done, your browser will prompt you to download a CSV file with your data. The database that the query runs on is dependent on what is your current session's selected database to work with, indicated on the top menu bar, on the Current database menu button. This input field will only run SELECT queries on the selected database. Any other query order type will return an error.","title":"queryRunner"},{"location":"frontend/queryrunner/#queryrunner-sql-form","text":"In the queryRunner tab of the web fronend, you get a text field where you can write your own SQL SELECT query, in the event that the packetstream table is limited for your needs. You need to write your SQL query inside of the text field on the page (as specified, the data table is always named main ), and when it's done, click on the Run query button to run it. Once done, your browser will prompt you to download a CSV file with your data. The database that the query runs on is dependent on what is your current session's selected database to work with, indicated on the top menu bar, on the Current database menu button. This input field will only run SELECT queries on the selected database. Any other query order type will return an error.","title":"queryRunner SQL form"},{"location":"getting-started/installation/","text":"Installing the server Once all of the system requirements are met, you can proceed on installing your environment. First, you need to setup the main server environment. Server install To install the server environment: git clone the PCAPAnalyzer installer repo cd to the cloned repo on the pcapanalyzer folder Navigate to the install folder Run the installer.py script with python3 installer.py when prompted for a confirmation, choose y or Y to enter the install script When prompted, enter s or S to perform a full server install. [!] If you already have a server install, you can upgrade it with u or U You will be asked to input a machineid. Choose a unique identifier for the host, like its hostname. Input the directory where you want the system to be installed. This directory needs to be inside one of your webroots accessible by apache2 . Input the postgresql admin user to create the environment. input the admin postgresql user password used to remotely connect to the system [!] The password is visible in plaintext in the terminal in this step. Be careful . Input the IP address where the postgresql install is set up Input the domain that the apache2 virtualhost will listen on. From the listed options, provide the system name of the interface you want the network sniffer to listen on. [!] you can input any to listen on all of the system's interfaces, but you can only have one entry. When the install is done, you will be provided with the pcapanalyzer agent password. Save this password, because it will be stored on the .my.cnf file, and you will probably need it later. You will be given a web frontend password for the admin account. save these credentials , because they are only stored on the database with a non-reversible cryptography algorithm and is not retrievable otherwise. If you want to, enable data logging on the PCAPAnalyzer server with service packetstream start . Once this installation is complete, you will have a functional PCAPAnalyzer install to use. To capture data from other machines, continue to the next section.","title":"Installation"},{"location":"getting-started/installation/#installing-the-server","text":"Once all of the system requirements are met, you can proceed on installing your environment. First, you need to setup the main server environment.","title":"Installing the server"},{"location":"getting-started/installation/#server-install","text":"To install the server environment: git clone the PCAPAnalyzer installer repo cd to the cloned repo on the pcapanalyzer folder Navigate to the install folder Run the installer.py script with python3 installer.py when prompted for a confirmation, choose y or Y to enter the install script When prompted, enter s or S to perform a full server install. [!] If you already have a server install, you can upgrade it with u or U You will be asked to input a machineid. Choose a unique identifier for the host, like its hostname. Input the directory where you want the system to be installed. This directory needs to be inside one of your webroots accessible by apache2 . Input the postgresql admin user to create the environment. input the admin postgresql user password used to remotely connect to the system [!] The password is visible in plaintext in the terminal in this step. Be careful . Input the IP address where the postgresql install is set up Input the domain that the apache2 virtualhost will listen on. From the listed options, provide the system name of the interface you want the network sniffer to listen on. [!] you can input any to listen on all of the system's interfaces, but you can only have one entry. When the install is done, you will be provided with the pcapanalyzer agent password. Save this password, because it will be stored on the .my.cnf file, and you will probably need it later. You will be given a web frontend password for the admin account. save these credentials , because they are only stored on the database with a non-reversible cryptography algorithm and is not retrievable otherwise. If you want to, enable data logging on the PCAPAnalyzer server with service packetstream start . Once this installation is complete, you will have a functional PCAPAnalyzer install to use. To capture data from other machines, continue to the next section.","title":"Server install"},{"location":"getting-started/post-install/","text":"Installing the agent When you already have a full server install, you may want to install the agent on host machines to gather data from them. The install steps for the agent are: git clone the PCAPAnalyzer installer repo cd to the cloned repo on the pcapanalyzer folder Navigate to the install folder Run the installer.py script with python3 installer.py when prompted for a confirmation, choose y or Y to enter the install script When prompted, enter a or A to perform an agent install. Input the postgresql database manager host IP that has the PCAPAnalyzer database install from your server. input the password that the server install generated for your PCAPAgent user. You will be asked to input a machineid. Choose a unique identifier for the host, like its hostname. input the absolute path where you want to install the agent. The team's recommendation is /opt/pcapagent/ . From the listed options, provide the system name of the interface you want the network sniffer to listen on. [!] you can input any to listen on all of the system's interfaces, but you can only have one entry. Enable the data logging with service packetstream start . Once this installation is complete, you will have a functional PCAPAnalyzer install to use.","title":"Post-install"},{"location":"getting-started/post-install/#installing-the-agent","text":"When you already have a full server install, you may want to install the agent on host machines to gather data from them. The install steps for the agent are: git clone the PCAPAnalyzer installer repo cd to the cloned repo on the pcapanalyzer folder Navigate to the install folder Run the installer.py script with python3 installer.py when prompted for a confirmation, choose y or Y to enter the install script When prompted, enter a or A to perform an agent install. Input the postgresql database manager host IP that has the PCAPAnalyzer database install from your server. input the password that the server install generated for your PCAPAgent user. You will be asked to input a machineid. Choose a unique identifier for the host, like its hostname. input the absolute path where you want to install the agent. The team's recommendation is /opt/pcapagent/ . From the listed options, provide the system name of the interface you want the network sniffer to listen on. [!] you can input any to listen on all of the system's interfaces, but you can only have one entry. Enable the data logging with service packetstream start . Once this installation is complete, you will have a functional PCAPAnalyzer install to use.","title":"Installing the agent"},{"location":"getting-started/prerequisites/","text":"Installation prerequisites Before you can set up a PCAPAnalyzer installation, you need to have a ready environment with the next elements: Server install This is the full server install that sets up the entire environment as front-end and back-end services for data gathering. You need to start with this one. Python3 is installed on your system You're running a system with Debian 10 or greater This system has access to the internet This system has at least 1 gigabyte of ram and a dual-core CPU This system has an active apache2 install, it can be a fresh one. You have administrator credentials to a local or remote PostgreSQL server You have administrator credentials for the machine and you're running the script as root A domain to point this website towards. It can be a local internal name. Agent install If you already have a full server install, you can install the agent on host machines to gather data from them. The prerequisites for the agent are: Python3 is installed on your system You're running a system with Debian 10 or greater This system has access to the internet This system has at least 1 gigabyte of ram and a dual-core CPU You have the agent login credentials given to you during the server install You have administrator credentials for the machine and you're running the script as root Once this setup is confirmed, you can proceed to installing the server.","title":"Prerequisites"},{"location":"getting-started/prerequisites/#installation-prerequisites","text":"Before you can set up a PCAPAnalyzer installation, you need to have a ready environment with the next elements:","title":"Installation prerequisites"},{"location":"getting-started/prerequisites/#server-install","text":"This is the full server install that sets up the entire environment as front-end and back-end services for data gathering. You need to start with this one. Python3 is installed on your system You're running a system with Debian 10 or greater This system has access to the internet This system has at least 1 gigabyte of ram and a dual-core CPU This system has an active apache2 install, it can be a fresh one. You have administrator credentials to a local or remote PostgreSQL server You have administrator credentials for the machine and you're running the script as root A domain to point this website towards. It can be a local internal name.","title":"Server install"},{"location":"getting-started/prerequisites/#agent-install","text":"If you already have a full server install, you can install the agent on host machines to gather data from them. The prerequisites for the agent are: Python3 is installed on your system You're running a system with Debian 10 or greater This system has access to the internet This system has at least 1 gigabyte of ram and a dual-core CPU You have the agent login credentials given to you during the server install You have administrator credentials for the machine and you're running the script as root Once this setup is confirmed, you can proceed to installing the server.","title":"Agent install"}]}